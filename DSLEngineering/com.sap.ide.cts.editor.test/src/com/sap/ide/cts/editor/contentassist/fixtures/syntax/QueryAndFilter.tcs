syntax QueryAndFilter {

	template test::reference::Library main context
		:	"library"
				"{" 
					"authors" authors 
					"books" books{ separator = ";" } 
				"}"
	;
	
	template test::reference::Author
		:	name
	;
	
	template test::reference::Book context
		:	title "by" 
			author{ 
				as=identifier,
				query="OCL:#context.oclAsType(test::reference::Book).library.authors->select(s | s.name.subString(name.size(),name.size()) = '=')", 
				filter="->select(s | s.name = ?.concat('='))", 
				invert="name.subString(1, -1+name.size())"
			}
	;
	
	
	
	---------------------- BELOW IS A MINIMAL SYNTAX -------------------------------
		
	primitiveTemplate identifier for PrimitiveTypes::String default using NAME:
		value = "unescapeString(%token%)";

	primitiveTemplate identifierOrKeyword for PrimitiveTypes::String using NAME orKeyword:
		value = "unescapeString(%token%)";

	primitiveTemplate stringSymbol for PrimitiveTypes::String using STRING:
		value = "unescapeString(%token%)",
		serializer="'\\\"' + %value%.toCString() + '\\\"'";

	primitiveTemplate integerSymbol for PrimitiveTypes::Integer default using INT:
		value = "Integer.valueOf(%token%)";

	primitiveTemplate floatSymbol for PrimitiveTypes::Double default using FLOAT:
		value = "Double.valueOf(%token%)";

	token COMMENT	: endOfLine(start = "--");
	
}
